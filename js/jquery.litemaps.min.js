(function(a){var b={mapid:0,limits:{},init:function(d){b.setSize(d,b.options.width,b.options.height);b.setMapId(d);if(b.options.staticmap){return b.staticmap(d)}var c=new google.maps.Map(d.get(0),b.options);b.setMap(d,c);b.setMarkers(d)},defaults:function(){return{zoom:"auto",center:"auto",type:"roadmap",markers:new Array(),height:"600px",width:"800px",staticmap:false}},initOptions:function(c){b.options={};var f=b.defaults();a.each(f,function(h,g){if(c[h]){b.options[h]=c[h]}else{b.options[h]=f[h]}});if(b.options.staticmap){return}b.options._zoom=b.options.zoom;b.options.zoom=15;b.options._center=b.options.center;b.options.center=new google.maps.LatLng(0,0);var d=b.getMapTypeList();b.options.mapTypeId=d[b.options.type]},setSize:function(d){var c=/^\d+$/;if(c.test(b.options.width)){b.options.width=parseInt(b.options.width,10)}if(c.test(b.options.height)){b.options.height=parseInt(b.options.height,10)}d.width(b.options.width);d.height(b.options.height)},getMapTypeList:function(){return{roadmap:google.maps.MapTypeId.ROADMAP,satellite:google.maps.MapTypeId.SATELLITE,hybrid:google.maps.MapTypeId.HYBRID,terrain:google.maps.MapTypeId.TERRAIN}},setMarkers:function(d){var c=b.getMapId(d);b.markers={};b.markers[c]=new Array();if(b.options.markers.length>0){var f=b.options.markers;a.each(f,function(g,i){if(i.lat&&i.lng){b.addMarker(d,i.lat,i.lng,i.content)}else{var h=i.address?i.address:i;var j=function(k,l){if(l){b.addMarker(d,k.lat(),k.lng(),i.content)}if(!b.geocodeIsPending()&&f.length==b._markers){b.eventMarkersAdded(d)}};b.geocode(h,j)}b._markers++})}if(!b.geocodeIsPending()){b.eventMarkersAdded(d)}},addMarker:function(j,h,d,g){var c=b.getMapId(j);b.markers[c].push({});var f=b.markers[c].length-1;b.markers[c][f].marker=new google.maps.Marker({position:new google.maps.LatLng(h,d),map:b.getMap(j)});if(g){b.markers[c][f].infowindow=new google.maps.InfoWindow({content:g});google.maps.event.addListener(b.markers[c][f].marker,"click",function(){b.markers[c][f].infowindow.open(b.getMap(j),b.markers[c][f].marker)})}return b.markers[c][f]},_markers:0,getLimits:function(d){var c=b.getMapId(d);if(!b.limits[c]){b.limits[c]=new google.maps.LatLngBounds();if(b.markers[c].length>0){a.each(b.markers[c],function(f,g){b.limits[c].extend(g.marker.getPosition())})}}return b.limits[c]},setCenter:function(g){var f=b.getMapId(g);if(b.options._center=="auto"){if(b.markers[f].length==1){var d=b.markers[f][0].marker;b.getMap(g).setCenter(d.getPosition())}else{if(b.markers[f].length>0){b.getMap(g).setCenter(b.getLimits(g).getCenter())}else{a.getScript("http://www.google.com/jsapi",function(){var i=new google.maps.Geocoder();if(google.loader.ClientLocation){loc={};loc.lat=google.loader.ClientLocation.latitude;loc.lng=google.loader.ClientLocation.longitude;var j=new google.maps.LatLng(loc.lat,loc.lng);b.getMap(g).setCenter(j)}})}}}else{if(b.options._center.lat&&b.options._center.lng){b.getMap(g).setCenter(new google.maps.LatLng(b.options._center.lat,b.options._center.lng))}else{var c=b.options._center;var h=function(i,k){if(k){var l=i.lat();var j=i.lng()}else{var l=0;var j=0}b.options._center={};b.options._center.lat=l;b.options._center.lng=j;b.setCenter(g)};b.geocode(c,h)}}},setZoom:function(d){var c=b.getMapId(d);if(b.options._zoom=="auto"){if(b.markers[c].length>1){b.getMap(d).fitBounds(b.getLimits(d))}else{b.getMap(d).setZoom(5)}}else{b.getMap(d).setZoom(parseInt(b.options._zoom,10))}},geocode:function(d,f){if(!b._geocoder){b._geocoder=new google.maps.Geocoder()}var c=function(j,h){b._geocodeRequests--;var g;var i=false;if(h==google.maps.GeocoderStatus.OK){var g=j[0].geometry.location;var i=true}f(g,i)};b._geocodeRequests++;b._geocoder.geocode({address:d},c);return b._geocoder},_geocodeRequests:0,geocodeIsPending:function(){return b._geocodeRequests>0},eventMarkersAdded:function(c){b.setCenter(c);b.setZoom(c)},staticmap:function(g){var c="http://maps.google.com/maps/api/staticmap";var f=["sensor=false"];f.push("size="+b.options.width+"x"+b.options.height);f.push("maptype="+b.options.type);var h=new Array();a.each(b.options.markers,function(i,j){if(j.lat&&j.lng){h.push(j.lat+","+j.lng)}else{if(j.address){h.push(j.address)}else{h.push(j)}}});if(h.length>0){h=h.join("|");f.push("markers="+h)}if(b.options.center!="auto"){if(b.options.center.lat&&b.options.center.lng){f.push("center="+b.options.center.lat+","+b.options.center.lng)}else{f.push("center="+b.options.center)}}if(b.options.zoom!="auto"){f.push("zoom="+b.options.zoom)}a.each(b.options,function(j,i){switch(j){case"markers":break;case"height":}});c=c+"?"+f.join("&");var d='<img src="'+c+'" alt="jQuery LiteMaps (http://github.com/lesergi/jquery.litemaps)" />';b.setMap(g,d);g.html(d)},setMap:function(d,c){d.data("litemaps_map",c)},getMap:function(c){return c.data("litemaps_map")},setMapId:function(c){c.data("litemaps_id",b.mapid++)},getMapId:function(c){return c.data("litemaps_id")}};a.fn.litemaps=function(){var c={};if(arguments[0]){c=arguments[0]}b.initOptions(c);a.each(this,function(){e=a(this);b.init(e)})}})(jQuery);